(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.removeAttribute("disabled",!0)):(t.classList.add(n.inactiveButtonClass),t.setAttribute("disabled",!0))}function n(e){"Escape"===e.key&&o(document.querySelector(".popup_is-opened"))}function r(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",n)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",n)}e.d({},{bG:()=>y,Hf:()=>h,hD:()=>q,rC:()=>S});var c={baseUrl:"https://nomoreparties.co/v1/cohort-55",headers:{authorization:"45aebeb9-2a42-44c0-8530-6775d47cd020","Content-Type":"application/json"}};function a(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function u(e,t){var n=y.querySelector(".element").cloneNode(!0),o=n.querySelector(".element__button-like"),u=n.querySelector(".element__delete"),i=n.querySelector(".element__image"),s=n.querySelector(".element__like-number");i.src=e.link,i.alt=e.name;var l=t,d=e.owner._id,f=e._id,m=e.likes;return s.textContent=m.length,n.querySelector(".element__title").textContent=e.name,o.addEventListener("click",(function(e){!function(e,t,n){var r;t.classList.contains("button_active")?(r=n,fetch("".concat(c.baseUrl,"/cards/likes/").concat(r),{method:"DELETE",headers:c.headers}).then((function(e){return a(e)}))).then((function(n){e.textContent=n.likes.length,t.classList.remove("button_active")})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:c.headers}).then((function(e){return a(e)}))}(n).then((function(n){e.textContent=n.likes.length,t.classList.add("button_active")})).catch((function(e){console.log(e)}))}(s,o,f)})),d!==l?u.classList.add("button_nonactive"):u.addEventListener("click",(function(e){var t;(t=f,fetch("".concat(c.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:c.headers}).then((function(e){return a(e)}))).then((function(e){u.closest(".element").remove()}))})),m.forEach((function(e){e._id==l&&o.classList.add("button_active")})),i.addEventListener("click",(function(t){r(h);var n=i;S.setAttribute("src",n.src),S.setAttribute("alt",n.alt),q.textContent=e.name})),n}var i,s=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),d=document.querySelector(".profile__title"),f=document.querySelector(".profile__subtitle"),m=document.querySelector("#edit-profile"),p=document.querySelector("#new-location"),v=document.querySelector('[name="edit_form"]'),_=document.querySelector('[name="add_form"]'),h=document.querySelector("#popup__image"),b=document.querySelector(".elements__list"),y=document.querySelector("#element-template").content,S=document.querySelector(".popup__image"),q=document.querySelector(".popup__about"),L=document.querySelectorAll(".popup__button-close"),E=v.querySelector('[name="firstname"]'),C=v.querySelector('[name="subtitle"]'),k=_.querySelector('[name="title"]'),A=_.querySelector('[name="link"]'),g=(document.querySelector(".elements__list"),document.querySelector("#edit_avatar")),x=document.querySelector('[name="avatar_edit_form"]'),U=document.querySelector(".profile__edit-avatar"),P=(document.querySelector(".profile__subtitle"),x.querySelector('[name="avatar"]')),O=document.querySelector(".profile__avatar");i={formSelector:".popup__form",inputSelector:".popup__text",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__text_type_error",errorClass:"popup__text_error_visible"},Array.from(document.querySelectorAll(i.formSelector)).forEach((function(e){!function(e,n){var r=e.querySelectorAll(n.inputSelector),o=Array.from(r),c=e.querySelector(n.submitButtonSelector);o.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var r=e.querySelector("#".concat(t.name,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""}(e,t,n):function(e,t,n,r){var o=e.querySelector("#".concat(t.name,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,r,n),t(o,c,n)}))})),t(o,c,n)}(e,i)})),s.addEventListener("click",(function(){E.value=d.textContent,C.value=f.textContent,r(m)})),l.addEventListener("click",(function(){r(p)})),U.addEventListener("click",(function(){r(g)})),v.addEventListener("submit",(function(e){e.preventDefault();var t,n,r=e.submitter;r.setAttribute("value","Сохранение..."),(t=E.value,n=C.value,fetch("".concat(c.baseUrl,"/users/me"),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return a(e)}))).then((function(e){d.textContent=e.name,f.textContent=e.about,o(m)})).catch((function(e){console.log(e)})).finally((function(){r.setAttribute("value","Сохранить")}))})),_.addEventListener("submit",(function(e){e.preventDefault();var t,n,r=e.submitter;r.setAttribute("value","Сохранение..."),(t=k.value,n=A.value,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return a(e)}))).then((function(t){var n=u(t,t.owner._id);b.prepend(n),e.target.reset(),o(p)})).catch((function(e){console.log(e)})).finally((function(){r.setAttribute("value","Создать"),r.classList.add("popup__button_disabled"),r.setAttribute("disabled",!0)}))})),x.addEventListener("submit",(function(e){e.preventDefault();var t,n=e.submitter;n.setAttribute("value","Сохранение..."),(t=P.value,fetch("".concat(c.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:t})}).then((function(e){return a(e)}))).then((function(t){O.setAttribute("src",t.avatar),e.target.reset(),o(g)})).catch((function(e){console.log(e)})).finally((function(){n.setAttribute("value","Сохранить")}))})),L.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return o(t)}))})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){t.target.classList.contains("popup_is-opened")&&o(e)}))})),Promise.all([fetch("".concat(c.baseUrl,"/users/me"),{headers:c.headers}).then((function(e){return a(e)})),fetch("".concat(c.baseUrl,"/cards"),{headers:c.headers}).then((function(e){return a(e)}))]).then((function(e){var t,n;!function(e){d.textContent=e.name,f.textContent=e.about,O.setAttribute("src",e.avatar)}(e[0]),t=e[1],n=e[0]._id,t.forEach((function(e){var t=u(e,n);b.append(t)}))})).catch((function(e){console.log(e)}))})();